<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="order">

	<select id="countOrderList" parameterType="string" resultType="int">
		select count(*) as cnt from order_tbl where member_id = #{memberId}
	</select>
	<select id="selectAllOrderList" parameterType="map" resultType="or">
		select 
		    order_no as orderNo,
		    member_id as memberId,
		    order_date as orderDate,
		    order_quan as orderQuan,
		    order_status as orderStatus,
		    shipping_phone as shippingPhone,
		    shipping_addr as shippingAddr,
		    (select p_name from market_product mp where ot.p_no = mp.p_no) as pName,
		    (select p_price from market_product mp where ot.p_no = mp.p_no) as pPrice
		from order_tbl ot
		where member_id = #{memberId}
		order by 4 desc
	</select>
	
	<insert id="nextOrder" parameterType="or">
	insert into order_tbl values(
	order_seq.nextval,
	#{memberId},
	null,
	to_char(sysydate,'yyyy-mm-dd'),
	#{orderQuan},
	#{orderPrice},
	'배송준비중',
	#{shippingName},
	'ㅇㅇ'
	
	)
    </insert>
    
    <delete id="deleteCart" parameterType="int">
		delete from cart where cart_no = #{cartNo}
	</delete>
	

</mapper>

